# Secrets

## Managed Secrets

| name                                | namespace                    | description                                                          |
| ----------------------------------- | ---------------------------- | -------------------------------------------------------------------- |
| `op-credentials`                    | `1password`                  | `1password-credentials.json` access to 1Password from Connect server |
| `onepassword-token`                 | `1password`                  | access 1Password Connect server                                      |
| `superset-secret-key`               | `superset`                   | a session cookie signing key for superset                            |
| `minio-console-credential--xcel`    | `minio-tenant-0`             | default login credentails for the MinIO console web application      |
| `minio-storage-configuration--xcel` | `minio-tenant-0`             | minio storage configuration including root user credentials          |
| `cloudflare--3d`                    | `cloudflare-operator-system` | access token for Cloudflare Zero Trust tunnels                       |

## Current State

- secrets are stored in a 1Password vault in my account named `k8s`
- there is a 1Password connect server defined named `argocd-dev`
- this connect server provides:
  - `1password-credentials.json` - used to authenticate from the connect server to 1Password
  - access token - used for clients to authenticate to the connect server
- the connect server is deployed via the `1password/connect` helm chart

## Future State

- secrets generated by [External Secrets Operator](https://external-secrets.io/latest/)
- secrets retrieved from external provider depending on environment(?):
  - `local` - 1Password
  - `xcel-on-prem` - AWS Secrets Manager

## Migration

```text
cloudflare--3d                    -> K8S/Local/Cloudflare.CLOUDFLARE_TUNNEL_CREDENTIAL_SECRET_LOCAL
minio-console--configuration-xcel -> K8S/Local/MinIO.config.env
minio-storage-credential--xcel    -> K8S/Local/MinIO.CONSOLE_ACCESS_KEY
minio-storage-credential--xcel    -> K8S/Local/MinIO.CONSOLE_SECRET_KEY
superset-secret-key               -> K8S/Local/Superset.credential

cloudflare--3d                    -> K8S/OnPrem/Cloudflare.CLOUDFLARE_TUNNEL_CREDENTIAL_SECRET_XCEL_ON_PREM
minio-console--configuration-xcel -> K8S/OnPrem/MinIO.config.env
minio-storage-credential--xcel    -> K8S/OnPrem/MinIO.CONSOLE_ACCESS_KEY
minio-storage-credential--xcel    -> K8S/OnPrem/MinIO.CONSOLE_SECRET_KEY
superset-secret-key               -> K8S/OnPrem/Superset.credential
```
